    <!DOCTYPE html>
    <html lang="en">
    <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Highcharts with Node.js</title>
      <script src="https://code.highcharts.com/highcharts.js"></script>
    </head>
    <body>
        <ul>
            <li><button onclick="fte();">Full Time Equivlients</button></li>
            <li><button onclick="grossOpExpend();">Gross Operating Expenditures</button></li>
            <li><button onclick="levySupported();">Net Levy-Supported Operating</button></li>
            <li><button onclick="otherRevenues();">Other Revenues</button></li>
            <li><button onclick="totalCap();">Total Captial Expenditures</button></li>
        </ul>

        <div id="container"></div>

        <script>
            var globaldata;
        
            function grossOpExpend(){
                chartdata = getLine("Gross Operating Expenditures", globaldata);
                setupChart("Gross Operating Expenditures", chartdata);
            }

            function otherRevenues(){
                chartdata = getLine("Other Revenues", globaldata);
                setupChart("Other Revenues", chartdata);
            }

            function levySupported(){
                chartdata = getLine("Net Tax Levy Supported Operating Budget", globaldata);
                setupChart("Net Tax Levy Supported Operating Budget", chartdata);
            }

            function totalCap(){
                chartdata = getLine("Total Capital Expenditures", globaldata);
                setupChart("Total Capital Expenditures", chartdata);
            }
            function fte(){
                chartdata = getLine("Full-Time Equivalents", globaldata);
                setupChart("Full-Time Equivalents", chartdata);
            }

            function getLine(budgetIndex, data){
                var ftearray = data;
                            
                var chartdata = { "type":"line", "categories": ["2024", "2025", "2026", "2027"], "series": []}


                for (const key in ftearray) {
                    if (ftearray.hasOwnProperty(key)) {
                       
                        var innerArray = data[key]["budget"];
                        console.log(innerArray)
        
                        var proceed= false;
                        var budgetObject = "";
                        innerArray.forEach(element => {
                            console.log(element["Budget Summary"]);
                            console.log(budgetIndex);
                            console.log("\n")
                            if(element["Budget Summary"] == budgetIndex){
                                proceed = true;
                                budgetObject = element;
                                console.log("IN Proceed!");
                            }
                           
                        });
                        if(proceed == true){
                            console.log("IN PROCEED");
                          var indivObject = {"name": `${key}`, "data": [`${budgetObject["2024"]}`, `${budgetObject["2025"]}`,`${budgetObject["2026"]}`, `${budgetObject["2027"]}`]};
                         }
                           
                    }
                    if(proceed == true){
                        indivObject.data = indivObject.data.map(value => {
                            
                            if (value === "N/A") return null;
                            if (typeof value === "string") {
                                value = value.replace(/[\$,]/g, ""); // Remove dollar sign and commas
                                value = value.replace(/\s/g, ""); // Remove spaces
                                
                                return parseFloat(value);
                            }
                            return value;
                        });

                        indivObject.dataLabels = {
                            enabled: true,
                            align: 'left',
                            verticalAlign: 'middle',
                            formatter: function() {
                                if (this.point.index === this.series.data.length - 1) {
                                return this.series.name;
                                }
                                return null;
                            },
                            crop: false,
                            overflow: 'none',
                            x: 10, // Adjust position
                            y: 0 // Adjust position
                        };

                        chartdata["series"].push(indivObject);
                    }
                } 
                return chartdata;     
            }

        function setupChart(chartTitle, chartdata){
            Highcharts.chart('container', {
                    chart: {
                        type: 'line',
                        height: '100%',
                        zoomType: 'y'
                    },
                    title: {
                        text: chartTitle
                    },
                    xAxis: {
                        categories: chartdata.categories
                    },
                    yAxis: {
                        title: {
                            text: 'Values'
                        },
                        min: null,
                        allowDecimals: false, // Ensure only integers are displayed
                         tickInterval: 1 // Set the interval between ticks to 1
                    },
                    legend: {
                        enabled: false // Hide the legend
                    },
                 
                    series: chartdata.series
                });
        }
            
        document.addEventListener('DOMContentLoaded', function () {
          fetch('/data')
            .then(response => response.json())
            .then(data => {
                globaldata = data;
                fte();
        })
            .catch(error => console.error('Error fetching data:', error)); 
            
        });
        </script>
    </body>
    </html>
